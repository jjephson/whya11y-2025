---
import BaseLayout from './BaseLayout.astro';
import PageHeader from '../components/PageHeader.astro';

export interface Props {
	title: string;
	description: string;
	date?: string;
	headerImage?: string;
	wcagCriteria?: Array<{
		code: string;
		title: string;
		url: string;
	}>;
	bestPractices?: string[];
	whoBenefits?: string[];
	relatedResources?: Array<{
		title: string;
		url: string;
	}>;
	testingTools?: Array<{
		title: string;
		url: string;
	}>;
}

const { 
	title, 
	description, 
	date, 
	headerImage, 
	wcagCriteria, 
	bestPractices, 
	whoBenefits, 
	relatedResources, 
	testingTools 
} = Astro.props;
---

<BaseLayout title={title} description={description}>
	<!-- Page Header Section -->
	<PageHeader 
		title={title}
		description={description}
		date={date}
	/>

	<!-- Two Column Layout -->
	<div class="example-layout">
		<!-- Main Content Column (2/3 width) -->
		<main class="example-main">
			<article class="example-content content-area">
				{headerImage && (
					<div class="example-header">
						<img src={headerImage} alt="" class="example-header-image" width="800" height="400" />
					</div>
				)}
				<div class="example-text" id="example-text">
					<slot />
				</div>
			</article>
		</main>

		<!-- Sidebar Column (1/3 width) -->
		<aside class="example-sidebar">
			<!-- WCAG Criteria Section -->
			<section class="sidebar-section">
				<h2>WCAG Criteria</h2>
				<ul class="wcag-list">
					{wcagCriteria?.map((criterion) => (
						<li>
							<a href={criterion.url} target="_blank" rel="noopener" aria-label={`${criterion.code}: ${criterion.title} (opens in new window)`}>
								{criterion.code}: {criterion.title}
							</a>
						</li>
					)) || (
						<li>No specific WCAG criteria listed</li>
					)}
				</ul>
			</section>

			<!-- Best Practices Section -->
			{bestPractices && (
				<section class="sidebar-section">
					<h2>Best Practices</h2>
					<ul class="practices-list">
						{bestPractices.map((practice) => (
							<li>{practice}</li>
						))}
					</ul>
				</section>
			)}

			<!-- Who Benefits Section -->
			{whoBenefits && (
				<section class="sidebar-section">
					<h2>Who Benefits</h2>
					<ul class="benefits-list">
						{whoBenefits.map((benefit) => (
							<li>{benefit}</li>
						))}
					</ul>
				</section>
			)}

			<!-- Related Resources -->
			{relatedResources && (
				<section class="sidebar-section">
					<h2>Related Resources</h2>
					<ul class="resources-list">
						{relatedResources.map((resource) => (
							<li>
								<a href={resource.url} target="_blank" rel="noopener" aria-label={`${resource.title} (opens in new window)`}>
									{resource.title}
								</a>
							</li>
						))}
					</ul>
				</section>
			)}

			<!-- Testing Tools -->
			{testingTools && (
				<section class="sidebar-section">
					<h2>Testing Tools</h2>
					<ul class="tools-list">
						{testingTools.map((tool) => (
							<li>
								<a href={tool.url} target="_blank" rel="noopener" aria-label={`${tool.title} (opens in new window)`}>
									{tool.title}
								</a>
							</li>
						))}
					</ul>
				</section>
			)}
		</aside>
	</div>
</BaseLayout>

<style>
	/* Two Column Layout */
	.example-layout {
		display: grid;
		grid-template-columns: 2fr 1fr;
		gap: var(--spacing-3xl);
		max-width: var(--container-lg);
		margin: 0 auto;
		align-items: start;
	}

	/* Main Content Area */
	.example-main {
		min-width: 0; /* Prevents grid overflow */
	}

	.example-content {
		background: var(--bg);
		border-radius: var(--radius-lg);
		overflow: hidden;
	}

	.example-header {
		margin: 0 0 var(--spacing-xl);
	}

	.example-header-image {
		width: 100%;
		height: auto;
		display: block;
	}

	.example-text {
		padding: 0;
	}

	/* Enhanced code block styling */
	.example-text pre {
		background: var(--bg-muted);
		padding: var(--spacing-lg);
		border-radius: var(--radius-md);
		overflow-x: auto;
		margin: var(--spacing-xl) 0;
		border: 1px solid var(--border);
		white-space: pre;
		word-wrap: normal;
		font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
		font-size: 0.9rem;
		line-height: 1.5;
		position: relative;
	}

	/* Language indicator for code blocks */
	.example-text pre[data-language]::before {
		content: attr(data-language);
		position: absolute;
		top: var(--spacing-sm);
		right: var(--spacing-sm);
		background: var(--accent-primary);
		color: var(--text-on-accent);
		padding: var(--spacing-xs) var(--spacing-sm);
		border-radius: var(--radius-sm);
		font-size: 0.75rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.05em;
	}

	/* Inline code styling */
	.example-text code {
		background: var(--bg-muted);
		padding: var(--spacing-xs) var(--spacing-sm);
		border-radius: var(--radius-sm);
		font-size: 0.9em;
		font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
	}

	/* Remove background and padding from code inside pre blocks */
	.example-text pre code {
		background: none;
		padding: 0;
		border-radius: 0;
	}

	/* Image styling within content */
	.example-text img {
		max-width: 100%;
		height: auto;
		border-radius: var(--radius-md);
		margin: var(--spacing-xl) 0;
	}

	/* Sidebar Styling */
	.example-sidebar {
		background: var(--bg-muted);
		border-radius: var(--radius-md);
		padding: var(--spacing-lg);
		border: 1px solid var(--border);
		height: fit-content;
		top: var(--spacing-xl);
	}

	.sidebar-section {
		margin-bottom: var(--spacing-xl);
	}

	.sidebar-section:last-child {
		margin-bottom: 0;
	}

	.sidebar-section h2 {
		font-size: var(--text-lg);
		margin: 0 0 var(--spacing-md);
		color: var(--fg);
		border-bottom: 2px solid var(--accent-primary);
		padding-bottom: var(--spacing-sm);
	}

	.sidebar-section ul {
		list-style: none;
		padding: 0;
		margin: 0;
	}

	.sidebar-section li {
		margin-bottom: var(--spacing-sm);
		font-size: var(--text-sm);
		line-height: var(--leading-relaxed);
	}

	.sidebar-section a {
		color: var(--fg-muted);
		text-decoration: underline;
		text-decoration-color: var(--accent-primary);
		text-underline-offset: 0.2em;
		text-decoration-thickness: 1px;
		font-size: 0.9rem;
		transition: all 0.2s ease;
	}

	.sidebar-section a:hover,
	.sidebar-section a:focus,
	.sidebar-section a:active {
		color: var(--text-on-accent);
		text-decoration-color: var(--text-on-accent);
		text-decoration-thickness: 2px;
	}

	/* Specific list styling */
	.wcag-list li {
		font-weight: 500;
	}

	.practices-list li,
	.benefits-list li {
		padding-left: var(--spacing-md);
		position: relative;
	}

	.practices-list li::before,
	.benefits-list li::before {
		content: "â€¢";
		color: var(--accent-primary);
		font-weight: bold;
		position: absolute;
		left: 0;
	}

	.resources-list li,
	.tools-list li {
		font-weight: 500;
	}

	/* Responsive Design */
	@media (max-width: 1024px) {
		.example-layout {
			grid-template-columns: 1fr;
			gap: var(--spacing-2xl);
		}

		.example-sidebar {
			position: static;
			order: 1; /* Move sidebar after main content on mobile */
		}

		.sidebar-section {
			margin-bottom: var(--spacing-lg);
		}
	}

	@media (max-width: 768px) {
		.example-sidebar {
			padding: var(--spacing-md);
		}

		.sidebar-section h2 {
			font-size: var(--text-base);
		}

		.example-text pre {
			padding: var(--spacing-md);
			font-size: 0.8rem;
		}

		.example-text pre[data-language]::before {
			font-size: 0.7rem;
			padding: 2px var(--spacing-xs);
		}
	}

	/* High contrast mode support */
	@media (prefers-contrast: high) {
		.example-sidebar {
			border: 2px solid var(--border);
		}

		.example-text pre {
			border: 2px solid var(--border);
		}
	}

	/* Reduced motion support */
	@media (prefers-reduced-motion: reduce) {
		.sidebar-section a {
			transition: none;
		}
	}
</style>
