---
import CodeExampleLayout from '../../layouts/CodeExampleLayout.astro';
import { getCollection } from 'astro:content';

/**
 * Code Example Page Template
 * 
 * This page renders individual code examples from the content/codeExamples collection.
 * 
 * HOW TO CREATE A CODE EXAMPLE:
 * 1. Create a new .md file in src/content/codeExamples/
 * 2. Add frontmatter with: title, description, date, and optional headerImage
 * 3. Write your content using markdown with code blocks
 * 
 * CODE BLOCK USAGE:
 * - Use ```html, ```css, ```js, etc. for syntax highlighting
 * - Code blocks automatically get proper padding and styling
 * - Inline code uses `backticks` for inline code styling
 * 
 * EXAMPLE FRONTMATTER:
 * ---
 * title: "Your Example Title"
 * description: "Brief description of what this example demonstrates"
 * date: "2024-12-19"
 * headerImage: "https://example.com/image.jpg" (optional)
 * ---
 */

export async function getStaticPaths() {
	const codeExamples = await getCollection('codeExamples');
	return codeExamples.map(example => ({
		params: { slug: example.slug },
		props: { example },
	}));
}

const { example } = Astro.props;
const { Content } = await example.render();

// Header image logic - uses provided image or generates a random one
const headerImage = example.data.headerImage || `https://source.unsplash.com/random/1200x320?sig=${Math.floor(Math.random()*1000)}`;
---

<CodeExampleLayout 
	title={example.data.title}
	description={example.data.description}
	date={example.data.date}
	headerImage={headerImage}
	wcagCriteria={example.data.wcagCriteria}
	bestPractices={example.data.bestPractices}
	whoBenefits={example.data.whoBenefits}
	relatedResources={example.data.relatedResources}
	testingTools={example.data.testingTools}
>
	<Content />
</CodeExampleLayout> 